---
---
<!doctype html>
<html lang="en">
  <head>
    {%- include head.html -%}
    <style>
      /* Lightweight lightbox styles (scoped to this layout) */
      .lightbox-backdrop {
        position: fixed; inset: 0; z-index: 1000;
        background: rgba(0,0,0,0.75);
        display: none; align-items: center; justify-content: center;
        padding: 4vmin;
      }
      .lightbox-backdrop.active { display: flex; }
      .lightbox-content {
        max-width: min(96vw, 1200px);
        max-height: 92vh;
        display: grid; gap: 0.5rem; justify-items: center;
        animation: lbFade 160ms ease-out;
      }
      .lightbox-content img {
        width: auto; height: auto; max-width: 100%; max-height: 85vh;
        border-radius: 10px; border: 1px solid rgba(255,255,255,0.15);
        background: #0b0d12;
      }
      .lightbox-caption { color: #cfd6dd; font-size: 0.95rem; text-align: center; }
      .lightbox-close {
        position: absolute; top: 14px; right: 16px; color: #e6edf3;
        background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.16);
        padding: 6px 10px; border-radius: 10px; cursor: pointer; font-weight: 700;
      }
      @keyframes lbFade { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: translateY(0); } }
      @media (prefers-reduced-motion: reduce) {
        .lightbox-content { animation: none !important; }
      }
      /* Make gallery thumbnails clickable affordance */
      .gallery-grid img { cursor: zoom-in; }
    </style>
  </head>
  <body>
    <!-- Ensure animated background exists on project pages too -->
    <div class="bg-canvas" aria-hidden="true"></div>

    {%- include header.html -%}
    <main class="container">
      <article class="project">
        <header class="project-header">
          <h1>{{ page.title }}</h1>
          {%- if page.subtitle -%}<p class="subtitle">{{ page.subtitle }}</p>{%- endif -%}
          <div class="meta">
            {%- if page.tech -%}<span class="tag">{{ page.tech | join: ', ' }}</span>{%- endif -%}
            {%- if page.date -%}<span class="tag">{{ page.date | date: "%b %d, %Y" }}</span>{%- endif -%}
            {%- if page.role -%}<span class="tag">Role: {{ page.role }}</span>{%- endif -%}
            {%- if page.status -%}<span class="tag status">{{ page.status }}</span>{%- endif -%}
          </div>
        </header>

        <section class="content">
          {{ content }}
        </section>

        {%- if page.images and page.images.size > 0 -%}
        <section class="gallery">
          <h2>Gallery</h2>
          <div class="gallery-grid">
            {%- for img in page.images -%}
              <figure>
                <img data-full="{{ img.src | relative_url }}"
                     src="{{ img.src | relative_url }}"
                     alt="{{ img.alt | default: page.title }}"
                     loading="lazy" />
                {%- if img.caption -%}<figcaption>{{ img.caption }}</figcaption>{%- endif -%}
              </figure>
            {%- endfor -%}
          </div>
        </section>
        {%- endif -%}

        {%- if page.links -%}
        <section class="links">
          <h2>Links</h2>
          <ul>
            {%- if page.links.demo -%}<li><a href="{{ page.links.demo }}" target="_blank" rel="noopener">Live Demo</a></li>{%- endif -%}
            {%- if page.links.repo -%}<li><a href="{{ page.links.repo }}" target="_blank" rel="noopener">Repository</a></li>{%- endif -%}
            {%- for extra in page.links.extra -%}
              <li><a href="{{ extra.url }}" target="_blank" rel="noopener">{{ extra.label }}</a></li>
            {%- endfor -%}
          </ul>
        </section>
        {%- endif -%}
      </article>
    </main>
    {%- include footer.html -%}

    <!-- Lightbox markup -->
    <div class="lightbox-backdrop" id="lightbox" aria-modal="true" role="dialog" aria-hidden="true">
      <div class="lightbox-content">
        <button class="lightbox-close" id="lightboxClose" aria-label="Close">Close</button>
        <img id="lightboxImg" alt="" />
        <div class="lightbox-caption" id="lightboxCaption"></div>
      </div>
    </div>

    <script>
      (function () {
        const lb = document.getElementById('lightbox');
        const lbImg = document.getElementById('lightboxImg');
        const lbCaption = document.getElementById('lightboxCaption');
        const lbClose = document.getElementById('lightboxClose');

        function openLightbox(src, caption, alt) {
          lbImg.src = src;
          lbImg.alt = alt || '';
          lbCaption.textContent = caption || '';
          lb.classList.add('active');
          lb.setAttribute('aria-hidden', 'false');
          document.body.style.overflow = 'hidden';
        }
        function closeLightbox() {
          lb.classList.remove('active');
          lb.setAttribute('aria-hidden', 'true');
          lbImg.src = '';
          document.body.style.overflow = '';
        }

        // Click on thumbnails
        document.querySelectorAll('.gallery-grid figure').forEach(fig => {
          const img = fig.querySelector('img');
          const capEl = fig.querySelector('figcaption');
          const caption = capEl ? capEl.textContent : '';
          img.addEventListener('click', () => {
            const src = img.getAttribute('data-full') || img.src;
            const alt = img.getAttribute('alt') || '';
            openLightbox(src, caption, alt);
          });
        });

        // Close interactions
        lb.addEventListener('click', (e) => {
          if (e.target === lb) closeLightbox();
        });
        lbClose.addEventListener('click', closeLightbox);
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape') closeLightbox();
        });
      })();
    </script>
  </body>
</html>